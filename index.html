<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ³¡ç››ãƒ¬ã‚³ãƒ¡ãƒ³ãƒ‰ - ã‚ãªãŸã«ã´ã£ãŸã‚Šã®ä¸€æ¯ã‚’</title>
<style>
  :root {
    --primary: #1a3a5c;
    --accent: #c5963a;
    --accent-light: #f5e6c8;
    --bg: #faf8f5;
    --card-bg: #ffffff;
    --text: #2c2c2c;
    --text-light: #6b6b6b;
    --border: #e0ddd8;
    --shadow: 0 2px 12px rgba(0,0,0,0.08);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Hiragino Kaku Gothic ProN', 'Noto Sans JP', sans-serif;
    background: var(--bg);
    color: var(--text);
    line-height: 1.7;
  }

  /* ===== Header ===== */
  header {
    background: linear-gradient(135deg, var(--primary) 0%, #2a5a8c 100%);
    color: #fff;
    text-align: center;
    padding: 2.5rem 1rem 2rem;
  }
  header h1 {
    font-size: 1.8rem;
    letter-spacing: 0.1em;
    margin-bottom: 0.3rem;
  }
  header p {
    font-size: 0.9rem;
    opacity: 0.85;
  }

  /* ===== Navigation Tabs ===== */
  .tab-nav {
    display: flex;
    justify-content: center;
    gap: 0;
    background: #fff;
    border-bottom: 2px solid var(--border);
    position: sticky;
    top: 0;
    z-index: 100;
  }
  .tab-btn {
    flex: 1;
    max-width: 220px;
    padding: 1rem 0.5rem;
    border: none;
    background: transparent;
    font-size: 0.95rem;
    font-weight: 600;
    color: var(--text-light);
    cursor: pointer;
    transition: all 0.2s;
    border-bottom: 3px solid transparent;
  }
  .tab-btn.active {
    color: var(--accent);
    border-bottom-color: var(--accent);
  }
  .tab-btn:hover { color: var(--accent); }

  /* ===== Tab Content ===== */
  .tab-content { display: none; padding: 1.5rem 1rem 3rem; max-width: 680px; margin: 0 auto; }
  .tab-content.active { display: block; }

  /* ===== Section Titles ===== */
  .section-title {
    font-size: 1.1rem;
    font-weight: 700;
    margin-bottom: 1rem;
    padding-left: 0.8rem;
    border-left: 4px solid var(--accent);
  }

  /* ===== Taste Map ===== */
  .taste-map-container {
    position: relative;
    width: 100%;
    max-width: 500px;
    margin: 0 auto 2rem;
    aspect-ratio: 1;
  }
  .taste-map-svg {
    width: 100%;
    height: 100%;
  }
  .taste-quadrant {
    cursor: pointer;
    transition: opacity 0.2s;
  }
  .taste-quadrant:hover { opacity: 0.85; }
  .taste-quadrant.selected { stroke: var(--accent); stroke-width: 3; }

  .taste-axis-label {
    font-size: 12px;
    fill: var(--text-light);
    font-weight: 600;
    pointer-events: none;
  }
  .taste-quadrant-label {
    font-size: 13px;
    fill: #fff;
    font-weight: 700;
    pointer-events: none;
    text-anchor: middle;
  }

  /* ===== Drink Preference ===== */
  .drink-selector {
    display: flex;
    flex-wrap: wrap;
    gap: 0.6rem;
    margin-bottom: 2rem;
  }
  .drink-chip {
    padding: 0.5rem 1rem;
    border: 2px solid var(--border);
    border-radius: 2rem;
    font-size: 0.85rem;
    cursor: pointer;
    transition: all 0.2s;
    background: #fff;
  }
  .drink-chip:hover { border-color: var(--accent); }
  .drink-chip.selected {
    background: var(--accent);
    color: #fff;
    border-color: var(--accent);
  }

  /* ===== Food Category ===== */
  .food-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
    gap: 0.8rem;
    margin-bottom: 2rem;
  }
  .food-card {
    background: var(--card-bg);
    border: 2px solid var(--border);
    border-radius: 12px;
    padding: 1rem 0.8rem;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s;
  }
  .food-card:hover { border-color: var(--accent); transform: translateY(-2px); }
  .food-card.selected {
    border-color: var(--accent);
    background: var(--accent-light);
  }
  .food-card .emoji { font-size: 2rem; margin-bottom: 0.3rem; }
  .food-card .label { font-size: 0.85rem; font-weight: 600; }

  /* ===== Result Cards ===== */
  .results-area { margin-top: 1.5rem; }
  .result-card {
    background: var(--card-bg);
    border-radius: 12px;
    padding: 1.2rem 1.2rem;
    margin-bottom: 1rem;
    box-shadow: var(--shadow);
    border-left: 4px solid var(--accent);
  }
  .result-card h3 {
    font-size: 1.1rem;
    margin-bottom: 0.2rem;
    color: var(--primary);
  }
  .result-card .brewery {
    font-size: 0.8rem;
    color: var(--text-light);
    margin-bottom: 0.6rem;
  }
  .result-card .tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.4rem;
    margin-bottom: 0.6rem;
  }
  .tag {
    display: inline-block;
    padding: 0.15rem 0.6rem;
    border-radius: 1rem;
    font-size: 0.75rem;
    font-weight: 600;
  }
  .tag-degree { background: #e8f0fe; color: #1a56db; }
  .tag-type { background: #fef3c7; color: #92400e; }
  .tag-taste { background: #ecfdf5; color: #065f46; }
  .result-card .description {
    font-size: 0.88rem;
    color: var(--text-light);
    line-height: 1.6;
  }
  .result-card .pairing {
    margin-top: 0.6rem;
    padding-top: 0.6rem;
    border-top: 1px solid var(--border);
    font-size: 0.85rem;
  }
  .pairing-label {
    font-weight: 700;
    color: var(--accent);
    font-size: 0.8rem;
  }
  .how-to-drink {
    margin-top: 0.5rem;
    font-size: 0.82rem;
    color: var(--text-light);
  }
  .how-to-drink strong { color: var(--text); }

  /* ===== CTA Button ===== */
  .cta-btn {
    display: block;
    width: 100%;
    max-width: 320px;
    margin: 1.5rem auto 0;
    padding: 0.9rem;
    background: linear-gradient(135deg, var(--accent), #d4a84a);
    color: #fff;
    border: none;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: 700;
    cursor: pointer;
    letter-spacing: 0.05em;
    transition: transform 0.15s, box-shadow 0.15s;
  }
  .cta-btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 16px rgba(197,150,58,0.35);
  }
  .cta-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
  }

  /* ===== Empty State ===== */
  .empty-state {
    text-align: center;
    padding: 2rem;
    color: var(--text-light);
    font-size: 0.9rem;
  }

  /* ===== Footer ===== */
  footer {
    text-align: center;
    padding: 1.5rem;
    font-size: 0.75rem;
    color: var(--text-light);
    border-top: 1px solid var(--border);
  }

  /* ===== Responsive ===== */
  @media (max-width: 480px) {
    header h1 { font-size: 1.4rem; }
    .food-grid { grid-template-columns: repeat(2, 1fr); }
  }
</style>
</head>
<body>

<header>
  <h1>æ³¡ç››ãƒ¬ã‚³ãƒ¡ãƒ³ãƒ‰</h1>
  <p>ã‚ãªãŸã«ã´ã£ãŸã‚Šã®æ³¡ç››ã¨æ–™ç†ã®çµ„ã¿åˆã‚ã›ã‚’è¦‹ã¤ã‘ã‚ˆã†</p>
</header>

<nav class="tab-nav">
  <button class="tab-btn active" data-tab="taste">å¥½ã¿ã§æ¢ã™</button>
  <button class="tab-btn" data-tab="food">æ–™ç†ã§æ¢ã™</button>
</nav>


<!-- ===== Tab 2: æ–™ç†ã§æ¢ã™ ===== -->
<div id="tab-food" class="tab-content">
  <h2 class="section-title">å¥½ããªæ–™ç†ã‚«ãƒ†ã‚´ãƒªãƒ¼ã‚’é¸ã‚“ã§ãã ã•ã„</h2>
  <div class="food-grid" id="food-grid">
    <div class="food-card" data-food="nikomi">
      <div class="emoji">ğŸ–</div>
      <div class="label">ç…®è¾¼ã¿æ–™ç†</div>
    </div>
    <div class="food-card" data-food="agemono">
      <div class="emoji">ğŸ¤</div>
      <div class="label">æšã’ç‰©</div>
    </div>
    <div class="food-card" data-food="itamemono">
      <div class="emoji">ğŸ¥˜</div>
      <div class="label">ç‚’ã‚ç‰©</div>
    </div>
    <div class="food-card" data-food="nabe">
      <div class="emoji">â™¨ï¸</div>
      <div class="label">é‹æ–™ç†</div>
    </div>
    <div class="food-card" data-food="kaisen">
      <div class="emoji">ğŸŸ</div>
      <div class="label">æµ·é®®ãƒ»åˆºèº«</div>
    </div>
    <div class="food-card" data-food="steak">
      <div class="emoji">ğŸ¥©</div>
      <div class="label">ã‚¹ãƒ†ãƒ¼ã‚­ãƒ»è‚‰</div>
    </div>
    <div class="food-card" data-food="italian">
      <div class="emoji">ğŸ</div>
      <div class="label">ã‚¤ã‚¿ãƒªã‚¢ãƒ³</div>
    </div>
    <div class="food-card" data-food="spicy">
      <div class="emoji">ğŸŒ¶ï¸</div>
      <div class="label">ã‚¹ãƒ‘ã‚¤ã‚·ãƒ¼æ–™ç†</div>
    </div>
    <div class="food-card" data-food="cheese">
      <div class="emoji">ğŸ§€</div>
      <div class="label">ãƒãƒ¼ã‚ºãƒ»å‰èœ</div>
    </div>
    <div class="food-card" data-food="dessert">
      <div class="emoji">ğŸ°</div>
      <div class="label">ãƒ‡ã‚¶ãƒ¼ãƒˆ</div>
    </div>
    <div class="food-card" data-food="okinawa">
      <div class="emoji">ğŸŒº</div>
      <div class="label">æ²–ç¸„æ–™ç†</div>
    </div>
    <div class="food-card" data-food="izakaya">
      <div class="emoji">ğŸ®</div>
      <div class="label">å±…é…’å±‹ãŠã¤ã¾ã¿</div>
    </div>
  </div>

  <button class="cta-btn" id="food-search-btn" disabled>ãŠã™ã™ã‚ã®æ³¡ç››ã‚’æ¢ã™</button>

  <div class="results-area" id="food-results">
    <div class="empty-state">æ–™ç†ã‚«ãƒ†ã‚´ãƒªãƒ¼ã‚’é¸ã‚“ã§ãã ã•ã„</div>
  </div>
</div>

<footer>
  æ³¡ç››ãƒ¬ã‚³ãƒ¡ãƒ³ãƒ‰ï½œãƒãƒƒã‚«ã‚½ãƒ³ 2026 ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—
</footer>

<script>
// ============================================================
// DATA LOADING
// ============================================================

let awamoriData = [];
let foodCategories = {};
let drinkMapping = {};

// Load data from external JSON file
async function loadData() {
  try {
    const response = await fetch('awamori-data.json');
    if (!response.ok) {
      throw new Error('ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ');
    }
    const data = await response.json();
    awamoriData = data.awamoriData;
    foodCategories = data.foodCategories;
    drinkMapping = data.drinkMapping;
    console.log('âœ… ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Œäº†:', awamoriData.length + 'ä»¶ã®æ³¡ç››');
  } catch (error) {
    console.error('âŒ ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
    alert('ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚');
  }
}

// ============================================================
// APP LOGIC
// ============================================================

let selectedQuadrant = null;
let selectedDrinks = new Set();
let selectedFoods = new Set();

// Initialize app when DOM is loaded
document.addEventListener('DOMContentLoaded', async () => {
  await loadData();
});

// Tab switching
document.querySelectorAll('.tab-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
    btn.classList.add('active');
    document.getElementById('tab-' + btn.dataset.tab).classList.add('active');
  });
});

// Quadrant selection
document.querySelectorAll('.taste-quadrant').forEach(q => {
  q.addEventListener('click', () => {
    document.querySelectorAll('.taste-quadrant').forEach(el => el.classList.remove('selected'));
    q.classList.add('selected');
    selectedQuadrant = q.dataset.quadrant;
    document.getElementById('taste-search-btn').disabled = false;
  });
});

// Drink chip selection
document.querySelectorAll('.drink-chip').forEach(chip => {
  chip.addEventListener('click', () => {
    chip.classList.toggle('selected');
    const drink = chip.dataset.drink;
    if (selectedDrinks.has(drink)) {
      selectedDrinks.delete(drink);
    } else {
      selectedDrinks.add(drink);
    }
  });
});

// Food card selection
document.querySelectorAll('.food-card').forEach(card => {
  card.addEventListener('click', () => {
    card.classList.toggle('selected');
    const food = card.dataset.food;
    if (selectedFoods.has(food)) {
      selectedFoods.delete(food);
    } else {
      selectedFoods.add(food);
    }
    document.getElementById('food-search-btn').disabled = selectedFoods.size === 0;
  });
});

// Taste-based search
document.getElementById('taste-search-btn').addEventListener('click', () => {
  if (!selectedQuadrant) return;

  // Primary: match quadrant
  let results = awamoriData.filter(a => a.quadrant === selectedQuadrant);

  // Score by drink similarity
  if (selectedDrinks.size > 0) {
    results = results.map(a => {
      const drinkScore = a.similarDrinks.filter(d => selectedDrinks.has(d)).length;
      return { ...a, score: drinkScore };
    }).sort((a, b) => b.score - a.score);
  }

  // If no results in exact quadrant, widen
  if (results.length === 0) {
    results = awamoriData.slice().sort((a, b) => {
      const aMatch = a.similarDrinks.filter(d => selectedDrinks.has(d)).length;
      const bMatch = b.similarDrinks.filter(d => selectedDrinks.has(d)).length;
      return bMatch - aMatch;
    }).slice(0, 3);
  }

  renderTasteResults(results);
});

// Food-based search
document.getElementById('food-search-btn').addEventListener('click', () => {
  if (selectedFoods.size === 0) return;

  const foodArr = [...selectedFoods];
  let scored = awamoriData.map(a => {
    const matchCount = a.pairings.filter(p => foodArr.includes(p)).length;
    return { ...a, score: matchCount };
  }).filter(a => a.score > 0).sort((a, b) => b.score - a.score);

  if (scored.length === 0) {
    scored = awamoriData.slice(0, 3).map(a => ({ ...a, score: 0 }));
  }

  renderFoodResults(scored);
});

// ============================================================
// RENDERING
// ============================================================

function renderTasteResults(results) {
  const container = document.getElementById('taste-results');
  if (results.length === 0) {
    container.innerHTML = '<div class="empty-state">æ¡ä»¶ã«åˆã†æ³¡ç››ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ</div>';
    return;
  }

  let drinkTip = '';
  if (selectedDrinks.size > 0) {
    const firstDrink = [...selectedDrinks][0];
    drinkTip = `<div style="background:var(--accent-light);padding:0.8rem 1rem;border-radius:8px;margin-bottom:1rem;font-size:0.88rem;">ğŸ’¡ ${drinkMapping[firstDrink]}</div>`;
  }

  container.innerHTML = drinkTip + results.map(a => `
    <div class="result-card">
      <h3>${a.name}</h3>
      <div class="brewery">${a.brewery}</div>
      <div class="tags">
        <span class="tag tag-degree">${a.degree}åº¦</span>
        <span class="tag tag-type">${a.type}</span>
      </div>
      <div class="description">${a.flavorProfile}</div>
      <div class="pairing">
        <div class="pairing-label">ãŠã™ã™ã‚ã®æ–™ç†</div>
        ${a.pairingDescription}
      </div>
      <div class="how-to-drink">
        <strong>é£²ã¿æ–¹ï¼š</strong>${a.recommendedDrink}
      </div>
    </div>
  `).join('');
}

function renderFoodResults(results) {
  const container = document.getElementById('food-results');
  const selectedFoodNames = [...selectedFoods].map(f => foodCategories[f]?.name).filter(Boolean).join('ã€');

  if (results.length === 0) {
    container.innerHTML = '<div class="empty-state">æ¡ä»¶ã«åˆã†æ³¡ç››ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ</div>';
    return;
  }

  const header = `<div style="background:var(--accent-light);padding:0.8rem 1rem;border-radius:8px;margin-bottom:1rem;font-size:0.88rem;">ğŸ½ï¸ ã€Œ${selectedFoodNames}ã€ã«åˆã†æ³¡ç››</div>`;

  container.innerHTML = header + results.map(a => {
    const matchedFoods = a.pairings
      .filter(p => selectedFoods.has(p))
      .map(p => foodCategories[p]?.name)
      .filter(Boolean);
    const matchLabel = matchedFoods.length > 0
      ? `<span class="tag tag-taste">${matchedFoods.join('ãƒ»')}ã«åˆã†</span>`
      : '';

    return `
      <div class="result-card">
        <h3>${a.name}</h3>
        <div class="brewery">${a.brewery}</div>
        <div class="tags">
          <span class="tag tag-degree">${a.degree}åº¦</span>
          <span class="tag tag-type">${a.type}</span>
          ${matchLabel}
        </div>
        <div class="description">${a.flavorProfile}</div>
        <div class="pairing">
          <div class="pairing-label">ãƒšã‚¢ãƒªãƒ³ã‚°ã®ãƒã‚¤ãƒ³ãƒˆ</div>
          ${a.pairingDescription}
        </div>
        <div class="how-to-drink">
          <strong>é£²ã¿æ–¹ï¼š</strong>${a.recommendedDrink}
        </div>
      </div>
    `;
  }).join('');
}
</script>
</body>
</html>
<!-- ===== Tab 1: å¥½ã¿ã§æ¢ã™ ===== -->
<div id="tab-taste" class="tab-content active">
  <h2 class="section-title">å‘³ã‚ã„ã®å¥½ã¿ã‚’é¸ã‚“ã§ãã ã•ã„</h2>
  <div class="taste-map-container">
    <svg class="taste-map-svg" viewBox="0 0 400 400">
      <!-- Background quadrants -->
      <rect class="taste-quadrant" data-quadrant="light-dry" x="5" y="5" width="193" height="193" rx="12" fill="#e0f2fe" />
      <rect class="taste-quadrant" data-quadrant="light-sweet" x="202" y="5" width="193" height="193" rx="12" fill="#fef3c7" />
      <rect class="taste-quadrant" data-quadrant="rich-dry" x="5" y="202" width="193" height="193" rx="12" fill="#ecfdf5" />
      <rect class="taste-quadrant" data-quadrant="rich-sweet" x="202" y="202" width="193" height="193" rx="12" fill="#fce7f3" />

      <!-- Axis labels -->
      <text class="taste-axis-label" x="200" y="20" text-anchor="middle">è»½ã‚„ã‹</text>
      <text class="taste-axis-label" x="200" y="395" text-anchor="middle">æ¿ƒåšãƒ»ã‚³ã‚¯ã‚ã‚Š</text>
      <text class="taste-axis-label" x="12" y="205" text-anchor="start" transform="rotate(-90, 12, 205)">è¾›å£ãƒ»ã‚­ãƒ¬</text>
      <text class="taste-axis-label" x="392" y="200" text-anchor="end" transform="rotate(90, 392, 200)">ç”˜å£ãƒ»ã¾ã‚ã‚„ã‹</text>

      <!-- Quadrant labels -->
      <text class="taste-quadrant-label" x="100" y="95" fill="#1a56db">è»½ã‚„ã‹Ã—ã‚­ãƒ¬</text>
      <text class="taste-quadrant-label" x="100" y="115" fill="#1a56db" font-size="11">ã‚¹ãƒƒã‚­ãƒªçˆ½å¿«ç³»</text>
      <text class="taste-quadrant-label" x="300" y="95" fill="#92400e">è»½ã‚„ã‹Ã—ç”˜å£</text>
      <text class="taste-quadrant-label" x="300" y="115" fill="#92400e" font-size="11">ãƒ•ãƒ«ãƒ¼ãƒ†ã‚£ãƒ¼ç³»</text>
      <text class="taste-quadrant-label" x="100" y="295" fill="#065f46">æ¿ƒåšÃ—ã‚­ãƒ¬</text>
      <text class="taste-quadrant-label" x="100" y="315" fill="#065f46" font-size="11">åŠ›å¼·ã„ä¼çµ±æ´¾</text>
      <text class="taste-quadrant-label" x="300" y="295" fill="#9d174d">æ¿ƒåšÃ—ç”˜å£</text>
      <text class="taste-quadrant-label" x="300" y="315" fill="#9d174d" font-size="11">ç†Ÿæˆãƒ»å¤é…’ç³»</text>
    </svg>
  </div>

  <h2 class="section-title">æ™®æ®µé£²ã‚€ãŠé…’ï¼ˆä»»æ„ï¼‰</h2>
  <div class="drink-selector" id="drink-selector">
    <div class="drink-chip" data-drink="beer">ãƒ“ãƒ¼ãƒ«</div>
    <div class="drink-chip" data-drink="sake">æ—¥æœ¬é…’</div>
    <div class="drink-chip" data-drink="shochu">ç„¼é…</div>
    <div class="drink-chip" data-drink="wine">ãƒ¯ã‚¤ãƒ³</div>
    <div class="drink-chip" data-drink="whisky">ã‚¦ã‚¤ã‚¹ã‚­ãƒ¼</div>
    <div class="drink-chip" data-drink="cocktail">ã‚«ã‚¯ãƒ†ãƒ«</div>
    <div class="drink-chip" data-drink="highball">ãƒã‚¤ãƒœãƒ¼ãƒ«</div>
    <div class="drink-chip" data-drink="chuhai">é…ãƒã‚¤</div>
  </div>

  <button class="cta-btn" id="taste-search-btn" disabled>ãŠã™ã™ã‚ã®æ³¡ç››ã‚’æ¢ã™</button>

  <div class="results-area" id="taste-results">
    <div class="empty-state">å‘³ã‚ã„ãƒãƒƒãƒ—ã‚’ã‚¿ãƒƒãƒ—ã—ã¦å¥½ã¿ã‚’é¸ã‚“ã§ãã ã•ã„</div>
  </div>
</div>
